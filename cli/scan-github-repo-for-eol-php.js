const dotenv = require('dotenv')
const { getPhpVersionVulnerabilitiesOfGitHubRepo } = require('../index')

dotenv.config()

const githubToken = process.env.GITHUB_TOKEN

const githubRepo = process.argv[2]
const versionsCsvUrl = process.argv[3]

if (!githubRepo) {
  console.error('Please specify a GitHub repo in the format "owner/repo"')
  process.exitCode = 1;
} else if (!versionsCsvUrl) {
  console.error('Please provide a URL for a CSV of PHP versions used in Docker images')
  process.exitCode = 1;
} else {
  getPhpVersionVulnerabilitiesOfGitHubRepo(
    githubToken,
    githubRepo,
    versionsCsvUrl
  ).then(console.log)
}
